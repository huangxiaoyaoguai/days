(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{276:function(e,i,t){"use strict";t.r(i);var r=t(19),n=Object(r.a)({},(function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"小程序中如何实现抖音的无限滑动效果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#小程序中如何实现抖音的无限滑动效果"}},[e._v("#")]),e._v(" 小程序中如何实现抖音的无限滑动效果")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("为什么要这个效果，主要是在有些业务中需要这种效果。（老板要求）")])]),e._v(" "),t("li",[t("p",[e._v("主要的用到的知识点\n小程序中的swiper用法，和video的用法")])]),e._v(" "),t("li",[t("p",[e._v("主要是利用swiper的效果，页面写上三个swiper然后在视频加载的过程中，切换swiper\n直接上代码吧")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('  <view class="container">\n  \t<swiper vertical circular wx:if="showSwper==1" class="swiper s1" current="0"  bindchange="changevideo">\n  \t\t<swiper-item  wx:for="videoArr1" item-id="item.id">\n  \t\t\t<video wx:if="item.id==id" class="myVideo"   autoplay src="item.video" danmu-list="danmuList" enable-danmu danmu-btn controls ></video>\n  \t\t\t<image wx:else src="item.img" class="img"></image>\n  \t\t</swiper-item>\n  \t</swiper>\n  \t<swiper vertical circular class="swiper s2" wx:if="showSwper==2" current="1"  bindchange="changevideo">\n  \t\t<swiper-item  wx:for="videoArr2" item-id="item.id">\n  \t\t\t<video wx:if="item.id==id" class="myVideo" autoplay src="item.video" danmu-list="danmuList" enable-danmu danmu-btn controls ></video>\n  \t\t\t<image wx:else src="item.img" class="img"></image>\n  \t\t\t</swiper-item>\n  \t</swiper>\n  \t<swiper vertical circular class="swiper s3" wx:if="showSwper==3" current="1"  bindchange="changevideo">\n  \t\t<swiper-item  wx:for="videoArr3" item-id="item.id">\n  \t\t\t<video wx:if="item.id==id" class="myVideo" autoplay src="item.video" danmu-list="danmuList" enable-danmu danmu-btn controls ></video>\n  \t\t\t<image wx:else src="item.img" class="img"></image>\n  \t\t\t</swiper-item>\n  \t\t</swiper>\n  </view>\n')])])])])]),e._v(" "),t("p",[e._v("js代码就是判断状态判定各种组件的渲染效果，保证每个swiper只渲染3个视频。以免swiper手机扛不住")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("\tgetVideo(id) {\n        var videoArr = this.data.videoArr;\n        var arr = [];\n        console.log(id)\n        videoArr.map((item, index) => {\n            if (item.id == id) {\n                if (index > 0) {\n                    arr.push(videoArr[index - 1])\n                }\n                arr.push(item)\n                if (index < videoArr.length - 1) {\n                    arr.push(videoArr[index + 1])\n                }\n            }\n        })\n        return arr\n        },\n\tchangevideo(e) {\n\t    var curr = e.detail.current;\n\t    var id = e.detail.currentItemId;\n\t    var arr = this.getVideo(id);\n\t    var showSwper = this.data.showSwper;\n\t    var name = showSwper!=2?'videoArr2':'videoArr3'\n\t    console.log(e,id)\n\t    console.log(name,arr)\n\t    this.setData({\n\t            [name]:arr,\n\t        })\n\t    setTimeout(() => {\n\t        this.setData({\n\t            id,\n\t            showSwper:showSwper!=2?2:3\n\t        })\n\t    }, 1000)\n\t},\n")])])]),t("p",[e._v("其中还有各种处理开头还有结尾的东西。就不展示了，需要根据业务的区别来改变")]),e._v(" "),t("ul",[t("li",[e._v("为什么用3个swiper而不是用2个\n主要是 swiper 中的 current判断是有渲染问题的，最后决定用3个，只有开头时用第一个，其他的时候是 2和3在轮流显示。")])]),e._v(" "),t("p",[e._v("效果（刷新查看）\n"),t("img",{attrs:{src:"https://cdn.weipaitang.com/static/20191009316af309-aa16-4c82-bdf2-780bd303335b-W314H673",alt:"avatar"}})])])}),[],!1,null,null,null);i.default=n.exports}}]);